% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CordBat.R
\name{CordBat}
\alias{CordBat}
\title{Batch Effect Correction using CordBat}
\usage{
CordBat(
  X,
  batch,
  group = NULL,
  grouping = FALSE,
  ref.batch,
  eps = 1e-05,
  print.detail = TRUE,
  skip.impute = FALSE
)
}
\arguments{
\item{X}{A numeric matrix of log-transformed expression data (samples x features).}

\item{batch}{A vector of batch identifiers corresponding to rows in `X`.}

\item{group}{An optional vector of group identifiers corresponding to rows in `X` (default: NULL).}

\item{grouping}{Logical indicating whether to use provided groupings (default: FALSE).}

\item{ref.batch}{The reference batch identifier.}

\item{eps}{Convergence threshold for batch effect correction (default: 1e-5).}

\item{print.detail}{Logical flag to print processing details (default: TRUE).}

\item{skip.impute}{Logical flag to detect, delete and impute outliers (default: FALSE)}
}
\value{
A list containing:
\itemize{
  \item \code{batch.level} - Unique batch levels.
  \item \code{delsampIdx} - Indices of deleted samples (outliers).
  \item \code{batch.new} - Updated batch assignments after outlier removal.
  \item \code{group.new} - Updated group assignments after outlier removal.
  \item \code{X.delout} - Data matrix after outlier removal.
  \item \code{X.cor} - Fully corrected data matrix (using outlier-free imputed data).
  \item \code{X.cor.1} - Corrected data matrix (using outlier-removed data).
  \item \code{X.cor.withQC} - Corrected data including QC samples (if present).
  \item \code{Xcor.para} - List of batch-specific correction parameters.
}
}
\description{
This function applies batch effect correction (BEC) using a community detection-based 
approach (CordBat). It handles outlier removal, imputation, and correction across batches.
}
\examples{
set.seed(123)
X <- matrix(rnorm(1000), 100, 10)
batch <- rep(1:5, each = 20)
res <- CordBat(X, batch, ref.batch = 1, print.detail = FALSE)
str(res)
}
